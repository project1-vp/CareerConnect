<!DOCTYPE html>
<html>
<head>
<title>CareerConnect Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
<style>
body{margin:0;font-family:'Segoe UI',sans-serif;height:100vh;display:flex;justify-content:center;align-items:center;background:#0f2027;overflow:hidden;}
#particles-js{position:absolute;width:100%;height:100%;z-index:-1;}
.navbar{position:fixed;top:0;width:100%;height:50px;background:rgba(0,0,0,0.4);backdrop-filter:blur(10px);display:flex;align-items:center;z-index:1000;}
.nav-container{width:92%;margin:auto;display:flex;justify-content:space-between;align-items:center;}
.navbar-brand{font-size:18px;font-weight:600;color:white;text-decoration:none;}
.back-btn{background:linear-gradient(45deg,#00ffcc,#00c6ff);border:none;padding:6px 16px;border-radius:18px;cursor:pointer;font-size:13px;font-weight:600;transition:.3s;}
.back-btn:hover{transform:scale(1.05);box-shadow:0 0 10px rgba(0,255,204,0.6);}
.card{background:rgba(255,255,255,0.1);backdrop-filter:blur(20px);padding:40px;border-radius:20px;width:380px;color:white;box-shadow:0 15px 35px rgba(0,0,0,0.5);animation:fadeIn 1s ease;}
@keyframes fadeIn{from{opacity:0; transform:translateY(40px);}to{opacity:1; transform:translateY(0);}}
.input-box{position:relative;margin:25px 0;}
.input-box input{width:100%;padding:10px;background:transparent;border:none;border-bottom:2px solid #aaa;color:#aaa;font-size:16px;outline:none;}
.input-box input:focus{border-bottom:2px solid #00ffcc;}
.input-box label{position:absolute;left:0;top:10px;color:#aaa;transition:.3s;pointer-events:none;}
.input-box input:focus + label,.input-box input:valid + label{top:-15px;font-size:12px;color:#00ffcc;}
#loginBtn{width:100%;padding:10px;margin-top:20px;border:none;border-radius:30px;background:linear-gradient(45deg,#00ffcc,#00c6ff);color:black;font-weight:bold;cursor:pointer;transition:.3s;}
#loginBtn:hover{transform:scale(1.05);box-shadow:0 0 15px #00ffcc;}
.loader{display:none;margin:15px auto;border:4px solid rgba(255,255,255,0.3);border-top:4px solid #00ffcc;border-radius:50%;width:30px;height:30px;animation:spin 1s linear infinite;}
@keyframes spin{100%{transform:rotate(360deg);}}
a{color:#00ffcc;text-decoration:none;}h2{text-align:center;}.note{font-size:12px; color:#b6c6d2; margin-top:8px; text-align:center;}
</style>
</head>
<body>
<nav class="navbar">
  <div class="nav-container">
    <a href="home.html" class="navbar-brand">CareerConnect</a>
    <button class="back-btn" onclick="goHome()">Back</button>
  </div>
</nav>

<div id="particles-js"></div>

<div class="card">
  <h2>Login</h2>
  <form id="loginForm">
    <div class="input-box">
      <input type="text" id="email" required>
      <label>Email or Username</label>
    </div>

    <div class="input-box">
      <input type="password" id="password" required>
      <label>Password</label>
    </div>

    <button type="submit" id="loginBtn">Login</button>
    <div class="loader" id="loader"></div>
  </form>

  <p class="note">Admin login: username <b>admin</b>, password <b>admin123</b></p>

  <p align="center">
    Don't have account?
    <a href="register.html">Register</a>
  </p>
</div>

<script>
function goHome(){ window.location.href="home.html"; }

particlesJS("particles-js",{
  particles:{ number:{value:60}, size:{value:3}, color:{value:"#00ffcc"}, move:{speed:2} }
});

document.getElementById("loginForm").addEventListener("submit", async function(e){
  e.preventDefault();

  const loader = document.getElementById("loader");
  const button = document.getElementById("loginBtn");
  loader.style.display = "block";
  button.style.display = "none";

  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value;

  try{
    const response = await fetch("http://localhost:5000/api/login",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({ email, password })
    });

    const data = await response.json();
    loader.style.display = "none";
    button.style.display = "block";

    if(!response.ok){
      alert(data.message || "Login failed");
      return;
    }

    localStorage.setItem("token", data.token);
    const normalizedRole = (data.role || "").toLowerCase().trim();
    localStorage.setItem("role", normalizedRole);

    const role = normalizedRole;
    if(role === "recruiter") window.location.href = "recruiter.html";
    else if(role === "job seeker" || role === "jobseeker" || role === "seeker") window.location.href = "jobseeker.html";
    else if(role === "admin") window.location.href = "admin.html";
    else window.location.href = "home.html";

  }catch(_error){
    loader.style.display = "none";
    button.style.display = "block";
    alert("Server Error");
  }
});
</script>
</body>
</html>


